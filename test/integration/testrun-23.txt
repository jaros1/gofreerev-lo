two google crome clents on different gofreerev servers
replicate gift from client 1 to client 2
send_gifts message is passed 5 times (20 seconds) while waiting for remote gift verification

client 2:

1)
GiftService.receive_message_send_gifts: mailbox  = {"did":"14311621396607257930","sha256":"ZnDMJUWStVAS9Zmvzx7Z2GHUDkKgShIlRvxPNj1m5Uc=","mutual_friends":[2,3],"server_id":1,"key":"14311621396607257930ZnDMJUWStVAS9Zmvzx7Z2GHUDkKgShIlRvxPNj1m5Uc=","online":true,"inbox":[],"read":[],"outbox":[{"mid":"14315934156584232849","request_mid":"14315933959390852926","msgtype":"sync_gifts","users":["kYDksLgCZUhxoGmapa5bAshZ0qylNPGkfg2WrmogF1Y="],"request_gifts":{"mid":"14315934156589716635","msgtype":"request_gifts","gifts":["14315931137417750564"]}}],"sending":[],"sent":[],"done":[{"msgtype":"users_sha256","mid":"14315933453298565341","users":[{"user_id":"kYDksLgCZUhxoGmapa5bAshZ0qylNPGkfg2WrmogF1Y="},{"user_id":"UuDJUQ2HbHmPZ08834UYQOIFDqLtQIafmUgeghW8WLI=","sha256":"\u00119<X\u0007ÞÖ¨ÁW\u001eÜ¥Á!Q×ï\u0007\u0012Èi\u000b\u0011Äò"}]},{"mid":"14315933876508217111","request_mid":"14315933396985349329","msgtype":"gifts_sha256","ignore_invalid_gifts":[],"users":["kYDksLgCZUhxoGmapa5bAshZ0qylNPGkfg2WrmogF1Y="],"gifts":[]}],"error":[]}
GiftService.receive_message_send_gifts: msg      = {"mid":"14315934017060501213","msgtype":"send_gifts","gifts":[{"gid":"14315931137417750564","giver_user_ids":["3+r+JyYSy8fZgWm9X6zoFEZEPeUj/NiEO/Si7zGW1Ho="],"receiver_user_ids":[],"created_at_client":1431593113,"created_at_server":0,"currency":"usd","direction":"giver","description":"client 1"}],"users":[],"servers":[{"server_id":0,"sha256":"KRM0c5eHrFpuQ3yGvHZdBPpGednZCjFsMpQzHTtVvAM="}],"request_mid":"14315933876508217111","pass":0}
GiftService.receive_message_send_gifts: msg.pass = 0
GiftService.validate_send_gifts_message: validating send_gifts message after received
GiftService.validate_send_gifts_message: mutual_friends = ["3+r+JyYSy8fZgWm9X6zoFEZEPeUj/NiEO/Si7zGW1Ho=","Y3kmoguG1c8fcUq3/0/YbjfQlmShu/1ZTs4RrLgzFJk=","7qRejUL/8ozUlvne42ig+cmqtO2d4tnYOOcyAqBD8Ow=","VBjJa8Mp3ik/LH6wEL55rFR1VZeXt8KSDn87bv9FhnQ="]
GiftService.validate_send_gifts_message: send_gifts_received_user_ids  =
GiftService.validate_send_gifts_message: send_gifts_expected_user_ids  =
GiftService.validate_send_gifts_message: send_gift_missing_user_ids    =
GiftService.validate_send_gifts_message: send_gift_unexpected_user_ids =
GiftService.invalid_gift: new_users_index = {}
GiftService.receive_message_send_gifts: other_server_id_to_sha256 = {"0":"KRM0c5eHrFpuQ3yGvHZdBPpGednZCjFsMpQzHTtVvAM="}
GiftService.receive_message_send_gifts: pass = 1, verify remote gift {"gid":"14315931137417750564","giver_user_ids":[2],"receiver_user_ids":[],"created_at_client":1431593113,"created_at_server":1,"currency":"usd","direction":"giver","description":"client 1","sha256":"9mÙ@¥ÔÖûÊ\u0010B«î¶Q:È\u0007k\u0013[´\u0019vCÛ\u0014Pm","sha256_gift":"Ürn¥J9³¸Yhj\u001d\róÅ? vböÞ/D1\u0019\u0016ø¶","sha256_comments":"_ìëfÿÈo8ÙRxlmilyÂÛÂ9ÝN´g)×:'ûWé"}
GiftService.verify_gifts_add: added gid 14315931137417750564 to verify gifts buffer
GiftService.receive_message_send_gifts: Waiting for 1 gifts and 0 comments to be server validated.
GiftService.receive_message_send_gifts: mailbox.read.length = 1
GiftService.receive_message_send_gifts: verify_gifts = [{"gid":"14315931137417750564","giver_user_ids":[2],"receiver_user_ids":[],"created_at_client":1431593113,"created_at_server":1,"currency":"usd","direction":"giver","description":"client 1","sha256":"9mÙ@¥ÔÖûÊ\u0010B«î¶Q:È\u0007k\u0013[´\u0019vCÛ\u0014Pm","sha256_gift":"Ürn¥J9³¸Yhj\u001d\róÅ? vböÞ/D1\u0019\u0016ø¶","sha256_comments":"_ìëfÿÈo8ÙRxlmilyÂÛÂ9ÝN´g)×:'ûWé","in_verify_gifts":1431593415}]
GiftService.receive_message_send_gifts: verify_comments = []
GiftService.process_messages: mailbox.read.length = 1
GiftService.verify_gifts_request: verify_gifts.length = 1
GiftService.verify_gifts_request: 1 new gift verification requests sent to server.
GiftService.verify_comments_request: Not implemented.
GiftService.send_messages: device.password = {!t:-r[59$d-gpMO=:2XfA%cKP @5fT!|hh}yGyJqI05@_2FQx4=J4fF/pMwW6 mhS5:N/St+h$cd!Ud
GiftService.send_messages: msg = {"mid":"14315934156584232849","request_mid":"14315933959390852926","msgtype":"sync_gifts","users":["kYDksLgCZUhxoGmapa5bAshZ0qylNPGkfg2WrmogF1Y="],"request_gifts":{"mid":"14315934156589716635","msgtype":"request_gifts","gifts":["14315931137417750564"]}}
GiftService.send_messages: unencrypted message = {"sent_at_client":1431593420635,"messages":[{"mid":"14315934156584232849","request_mid":"14315933959390852926","msgtype":"sync_gifts","users":["kYDksLgCZUhxoGmapa5bAshZ0qylNPGkfg2WrmogF1Y="],"request_gifts":{"mid":"14315934156589716635","msgtype":"request_gifts","gifts":["14315931137417750564"]}}]}
GiftService.send_messages: message_with_envelope = {"receiver_did":"14311621396607257930","receiver_sha256":"ZnDMJUWStVAS9Zmvzx7Z2GHUDkKgShIlRvxPNj1m5Uc=","server":false,"encryption":"sym","message":"U2FsdGVkX1/zc6m8Udjl7AosAdTHa1ri/D9pHr6lWLxTJBs65LSsTbbgwf7PzEhLxwqNBCWcKEejqrZUDOOg2wJItG21KKUomQwo7zJWHwnVNwjHxdrzrF+lWtXSPV2rHK5thK/2yng6cge9e+KlsjfyHwuchvLk11ReU6cHoRIVVBFeESnjJW0dn39/vgn8UE0KsHa+n9AtV1FMUDAd4hWTqCPlKIjz5iQ4KawS6ri8g/X+9p8ZdQmJr0SECnlIRuIFHkiae1Nru0phIS1ysx43XF+0mJNMUKHad7CPd3tnpmzw7zlsGsmu7zwz2g4A8XRIk6onM9YDPLDQY9e7aNqoW94shnC7WpCE+lanTAa14dipOh4uAFFyRvPYHnJDNqW0OKfVKVmuu/l61UgB15NPszpjZz4zy91b1LO1HF4="}
GiftService.process_messages: 1 messages was moved from mailbox.read to mailbox.inbox

2)
GiftService.receive_message_send_gifts: mailbox  = {"did":"14311621396607257930","sha256":"ZnDMJUWStVAS9Zmvzx7Z2GHUDkKgShIlRvxPNj1m5Uc=","mutual_friends":[2,3],"server_id":1,"key":"14311621396607257930ZnDMJUWStVAS9Zmvzx7Z2GHUDkKgShIlRvxPNj1m5Uc=","online":true,"inbox":[],"read":[],"outbox":[],"sending":[],"sent":[{"mid":"14315934156584232849","request_mid":"14315933959390852926","msgtype":"sync_gifts","users":["kYDksLgCZUhxoGmapa5bAshZ0qylNPGkfg2WrmogF1Y="],"request_gifts":{"mid":"14315934156589716635","msgtype":"request_gifts","gifts":["14315931137417750564"]}}],"done":[{"msgtype":"users_sha256","mid":"14315933453298565341","users":[{"user_id":"kYDksLgCZUhxoGmapa5bAshZ0qylNPGkfg2WrmogF1Y="},{"user_id":"UuDJUQ2HbHmPZ08834UYQOIFDqLtQIafmUgeghW8WLI=","sha256":"\u00119<X\u0007ÞÖ¨ÁW\u001eÜ¥Á!Q×ï\u0007\u0012Èi\u000b\u0011Äò"}]},{"mid":"14315933876508217111","request_mid":"14315933396985349329","msgtype":"gifts_sha256","ignore_invalid_gifts":[],"users":["kYDksLgCZUhxoGmapa5bAshZ0qylNPGkfg2WrmogF1Y="],"gifts":[]}],"error":[]}
...
GiftService.receive_message_send_gifts: Waited 6 seconds for gift 14315931137417750564 verification
GiftService.receive_message_send_gifts: Waiting for 1 gifts and 0 comments to be server validated.

3)
GiftService.receive_message_send_gifts: mailbox  = {"did":"14311621396607257930","sha256":"ZnDMJUWStVAS9Zmvzx7Z2GHUDkKgShIlRvxPNj1m5Uc=","mutual_friends":[2,3],"server_id":1,"key":"14311621396607257930ZnDMJUWStVAS9Zmvzx7Z2GHUDkKgShIlRvxPNj1m5Uc=","online":true,"inbox":[],"read":[],"outbox":[],"sending":[],"sent":[{"mid":"14315934156584232849","request_mid":"14315933959390852926","msgtype":"sync_gifts","users":["kYDksLgCZUhxoGmapa5bAshZ0qylNPGkfg2WrmogF1Y="],"request_gifts":{"mid":"14315934156589716635","msgtype":"request_gifts","gifts":["14315931137417750564"]}}],"done":[{"msgtype":"users_sha256","mid":"14315933453298565341","users":[{"user_id":"kYDksLgCZUhxoGmapa5bAshZ0qylNPGkfg2WrmogF1Y="},{"user_id":"UuDJUQ2HbHmPZ08834UYQOIFDqLtQIafmUgeghW8WLI=","sha256":"\u00119<X\u0007ÞÖ¨ÁW\u001eÜ¥Á!Q×ï\u0007\u0012Èi\u000b\u0011Äò"}]},{"mid":"14315933876508217111","request_mid":"14315933396985349329","msgtype":"gifts_sha256","ignore_invalid_gifts":[],"users":["kYDksLgCZUhxoGmapa5bAshZ0qylNPGkfg2WrmogF1Y="],"gifts":[]}],"error":[]}
...
GiftService.receive_message_send_gifts: Waited 11 seconds for gift 14315931137417750564 verification
GiftService.receive_message_send_gifts: Waiting for 1 gifts and 0 comments to be server validated.

4)
GiftService.receive_message_send_gifts: mailbox  = {"did":"14311621396607257930","sha256":"ZnDMJUWStVAS9Zmvzx7Z2GHUDkKgShIlRvxPNj1m5Uc=","mutual_friends":[2,3],"server_id":1,"key":"14311621396607257930ZnDMJUWStVAS9Zmvzx7Z2GHUDkKgShIlRvxPNj1m5Uc=","online":true,"inbox":[],"read":[],"outbox":[],"sending":[],"sent":[{"mid":"14315934156584232849","request_mid":"14315933959390852926","msgtype":"sync_gifts","users":["kYDksLgCZUhxoGmapa5bAshZ0qylNPGkfg2WrmogF1Y="],"request_gifts":{"mid":"14315934156589716635","msgtype":"request_gifts","gifts":["14315931137417750564"]}}],"done":[{"msgtype":"users_sha256","mid":"14315933453298565341","users":[{"user_id":"kYDksLgCZUhxoGmapa5bAshZ0qylNPGkfg2WrmogF1Y="},{"user_id":"UuDJUQ2HbHmPZ08834UYQOIFDqLtQIafmUgeghW8WLI=","sha256":"\u00119<X\u0007ÞÖ¨ÁW\u001eÜ¥Á!Q×ï\u0007\u0012Èi\u000b\u0011Äò"}]},{"mid":"14315933876508217111","request_mid":"14315933396985349329","msgtype":"gifts_sha256","ignore_invalid_gifts":[],"users":["kYDksLgCZUhxoGmapa5bAshZ0qylNPGkfg2WrmogF1Y="],"gifts":[]}],"error":[]}
...
GiftService.receive_message_send_gifts: Waited 15 seconds for gift 14315931137417750564 verification
GiftService.receive_message_send_gifts: Waiting for 1 gifts and 0 comments to be server validated.

5)
GiftService.receive_message_send_gifts: mailbox  = {"did":"14311621396607257930","sha256":"ZnDMJUWStVAS9Zmvzx7Z2GHUDkKgShIlRvxPNj1m5Uc=","mutual_friends":[2,3],"server_id":1,"key":"14311621396607257930ZnDMJUWStVAS9Zmvzx7Z2GHUDkKgShIlRvxPNj1m5Uc=","online":true,"inbox":[],"read":[],"outbox":[],"sending":[],"sent":[{"mid":"14315934156584232849","request_mid":"14315933959390852926","msgtype":"sync_gifts","users":["kYDksLgCZUhxoGmapa5bAshZ0qylNPGkfg2WrmogF1Y="],"request_gifts":{"mid":"14315934156589716635","msgtype":"request_gifts","gifts":["14315931137417750564"]}}],"done":[{"msgtype":"users_sha256","mid":"14315933453298565341","users":[{"user_id":"kYDksLgCZUhxoGmapa5bAshZ0qylNPGkfg2WrmogF1Y="},{"user_id":"UuDJUQ2HbHmPZ08834UYQOIFDqLtQIafmUgeghW8WLI=","sha256":"\u00119<X\u0007ÞÖ¨ÁW\u001eÜ¥Á!Q×ï\u0007\u0012Èi\u000b\u0011Äò"}]},{"mid":"14315933876508217111","request_mid":"14315933396985349329","msgtype":"gifts_sha256","ignore_invalid_gifts":[],"users":["kYDksLgCZUhxoGmapa5bAshZ0qylNPGkfg2WrmogF1Y="],"gifts":[]}],"error":[]}
GiftService.receive_message_send_gifts: msg      = {"mid":"14315934017060501213","msgtype":"send_gifts","gifts":[{"gid":"14315931137417750564","giver_user_ids":[2],"receiver_user_ids":[],"created_at_client":1431593113,"created_at_server":1,"currency":"usd","direction":"giver","description":"client 1","sha256":"9mÙ@¥ÔÖûÊ\u0010B«î¶Q:È\u0007k\u0013[´\u0019vCÛ\u0014Pm","sha256_gift":"Ürn¥J9³¸Yhj\u001d\róÅ? vböÞ/D1\u0019\u0016ø¶","sha256_comments":"_ìëfÿÈo8ÙRxlmilyÂÛÂ9ÝN´g)×:'ûWé","in_verify_gifts":1431593415,"verify_seq":-27,"verified_at_server":true}],"users":[],"servers":[{"server_id":0,"sha256":"KRM0c5eHrFpuQ3yGvHZdBPpGednZCjFsMpQzHTtVvAM="}],"request_mid":"14315933876508217111","pass":1}
GiftService.receive_message_send_gifts: msg.pass = 1
GiftService.receive_message_send_gifts: pass = 1, verify remote gift {"gid":"14315931137417750564","giver_user_ids":[2],"receiver_user_ids":[],"created_at_client":1431593113,"created_at_server":1,"currency":"usd","direction":"giver","description":"client 1","sha256":"9mÙ@¥ÔÖûÊ\u0010B«î¶Q:È\u0007k\u0013[´\u0019vCÛ\u0014Pm","sha256_gift":"Ürn¥J9³¸Yhj\u001d\róÅ? vböÞ/D1\u0019\u0016ø¶","sha256_comments":"_ìëfÿÈo8ÙRxlmilyÂÛÂ9ÝN´g)×:'ûWé","in_verify_gifts":1431593415,"verify_seq":-27,"verified_at_server":true}
GiftService.receive_message_send_gifts: pass 3 - create gift and valid comments. gift = {"gid":"14315931137417750564","giver_user_ids":[2],"receiver_user_ids":[],"created_at_client":1431593113,"created_at_server":1,"currency":"usd","direction":"giver","description":"client 1","sha256":"9mÙ@¥ÔÖûÊ\u0010B«î¶Q:È\u0007k\u0013[´\u0019vCÛ\u0014Pm","sha256_gift":"Ürn¥J9³¸Yhj\u001d\róÅ? vböÞ/D1\u0019\u0016ø¶","sha256_comments":"_ìëfÿÈo8ÙRxlmilyÂÛÂ9ÝN´g)×:'ûWé","in_verify_gifts":1431593415,"verify_seq":-27,"verified_at_server":true}
GiftService.invalid_gift: new_users_index = {}
GiftService.receive_message_send_gifts: pass 3 - todo: create valid comments. gift = {"gid":"14315931137417750564","giver_user_ids":[2],"receiver_user_ids":[],"created_at_client":1431593113,"created_at_server":1,"currency":"usd","direction":"giver","description":"client 1","sha256":"9mÙ@¥ÔÖûÊ\u0010B«î¶Q:È\u0007k\u0013[´\u0019vCÛ\u0014Pm","sha256_gift":"Ürn¥J9³¸Yhj\u001d\róÅ? vböÞ/D1\u0019\u0016ø¶","sha256_comments":"_ìëfÿÈo8ÙRxlmilyÂÛÂ9ÝN´g)×:'ûWé","in_verify_gifts":1431593415,"verify_seq":-27,"verified_at_server":true,"pass":3}
GiftService.receive_message_send_gifts: pass = 1, error report missing
GiftService.receive_message_send_gifts: Ok. Created gifts 14315931137417750564
GiftService.process_messages: mailbox.read.length = 0
GiftService.verify_comments_request: Not implemented.
