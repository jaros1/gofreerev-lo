testrun-28
remove comment verification
sending one new gift with one new comment from client 1 on app 1 to client 2 on app 2


client 2:

GiftService.verify_gifts_response: Received 1 verifications for 1 gifts (1 valid and 0 invalid).
GiftService.process_messages: 1 messages was moved from mailbox.read to mailbox.inbox
GiftService.receive_message_send_gifts: mailbox  = {"did":"14311621396607257930","sha256":"ZnDMJUWStVAS9Zmvzx7Z2GHUDkKgShIlRvxPNj1m5Uc=","mutual_friends":[2,3],"server_id":1,"key":"14311621396607257930ZnDMJUWStVAS9Zmvzx7Z2GHUDkKgShIlRvxPNj1m5Uc=","online":true,"inbox":[],"read":[],"outbox":[],"sending":[],"sent":[{"mid":"14319342930632741079","request_mid":"14319342826847294355","msgtype":"sync_gifts","users":["kYDksLgCZUhxoGmapa5bAshZ0qylNPGkfg2WrmogF1Y="],"request_gifts":{"mid":"14319342930630675113","msgtype":"request_gifts","gifts":["14318503987470039958"]}}],"done":[{"msgtype":"users_sha256","mid":"14319342415639949279","users":[{"user_id":"kYDksLgCZUhxoGmapa5bAshZ0qylNPGkfg2WrmogF1Y="},{"user_id":"UuDJUQ2HbHmPZ08834UYQOIFDqLtQIafmUgeghW8WLI=","sha256":"\u00119<X\u0007ÞÖ¨ÁW\u001eÜ¥Á!Q×ï\u0007\u0012Èi\u000b\u0011Äò"}]},{"mid":"14319342715683313644","request_mid":"14319342462133092793","msgtype":"gifts_sha256","ignore_invalid_gifts":[],"users":["kYDksLgCZUhxoGmapa5bAshZ0qylNPGkfg2WrmogF1Y="],"gifts":[]}],"error":[]}
GiftService.receive_message_send_gifts: msg      = {"mid":"14319342827048541482","msgtype":"send_gifts","gifts":[{"gid":"14318503987470039958","giver_user_ids":[2],"receiver_user_ids":[],"created_at_client":1431850398,"created_at_server":1,"currency":"usd","direction":"giver","description":"client 1","comments":[{"cid":"14318504067620296473","user_ids":[2],"currency":"usd","comment":"client 1","created_at_client":1431850406,"created_at_server":1}],"sha256":"\u0004uzÌªs´IöÜÍnQ\u001c\u001d\u001b_¥»cij°ªÍrÁÍMá","sha256_gift":"Ürn¥J9³¸Yhj\u001d\róÅ? vböÞ/D1\u0019\u0016ø¶","sha256_comments":"dlM<»0©Mã{U«\tï1³\u000b]Ó0,\u0000´\u001cÙò«","in_verify_gifts":1431934293,"verify_seq":-47,"verified_at_server":true}],"users":[],"servers":[{"server_id":0,"sha256":"KRM0c5eHrFpuQ3yGvHZdBPpGednZCjFsMpQzHTtVvAM="}],"request_mid":"14319342715683313644","pass":1}
GiftService.receive_message_send_gifts: msg.pass = 1
GiftService.receive_message_send_gifts: pass = 1, verify remote gift {"gid":"14318503987470039958","giver_user_ids":[2],"receiver_user_ids":[],"created_at_client":1431850398,"created_at_server":1,"currency":"usd","direction":"giver","description":"client 1","comments":[{"cid":"14318504067620296473","user_ids":[2],"currency":"usd","comment":"client 1","created_at_client":1431850406,"created_at_server":1}],"sha256":"\u0004uzÌªs´IöÜÍnQ\u001c\u001d\u001b_¥»cij°ªÍrÁÍMá","sha256_gift":"Ürn¥J9³¸Yhj\u001d\róÅ? vböÞ/D1\u0019\u0016ø¶","sha256_comments":"dlM<»0©Mã{U«\tï1³\u000b]Ó0,\u0000´\u001cÙò«","in_verify_gifts":1431934293,"verify_seq":-47,"verified_at_server":true}
GiftService.verify_comments_add: added cid 14318504067620296473 to verify comments buffer
GiftService.receive_message_send_gifts: Waiting for 0 gifts and 1 comments to be server validated.
...
GiftService.receive_message_send_gifts: Waiting for 0 gifts and 1 comments to be server validated.
GiftService.receive_message_send_gifts: mailbox.read.length = 1
GiftService.receive_message_send_gifts: verify_gifts = []
GiftService.receive_message_send_gifts: verify_comments = []
GiftService.process_messages: mailbox.read.length = 1
GiftService.verify_comments_request: Warning. Found 0 local and 1 remote not yet verified comments in buffer.
NavCtrl.ping: Error in JSON ping response from server.
NavCtrl.ping: response:
  {"old_client_timestamp":1431934322838,
   "interval":4000,
   "online":[{"did":"14311621396607257930","sha256":"ZnDMJUWStVAS9Zmvzx7Z2GHUDkKgShIlRvxPNj1m5Uc=","mutual_friends":[2,3],"server_id":1}],
   "verify_comments":{"comments":[{"seq":-48,"cid":"14318504067620296473","verified_at_server":true}]},
   "error":"Invalid ping response: The property '#/verify_comments/comments/0' did not contain a required property of 'created_at_server' in schema 41afbe6e-5f7d-548f-b91a-a51ad4d58c9a#, The property '#/verify_comments/comments/0' contains additional properties [\"verified_at_server\"] outside of the schema when none are allowed in schema 41afbe6e-5f7d-548f-b91a-a51ad4d58c9a#"}
NavCtrl.ping: schema: {"type":"object","title":"Receive response from server and receive messages from other clients","properties":{"old_client_timestamp":{"type":"integer","minimum":1431843937000,"maximum":1463552737000},"interval":{"type":"integer","minimum":1000},"online":{"type":"array","title":"Array with online friends","description":"Did is unique device id. sha256 is signature with client secret and current logged in users. sha256 changes when api provider login changes for a device. Did+sha256 is used as unique mailbox address. Mutual_friends is an array with mutual friends between did and friend did. Synchronize only information for mutual friends. Server id used for communication with friends on other gofreerev servers","items":{"type":"object","properties":{"did":{"type":"string","pattern":"^(146355273[0-7]|14635527[0-2][0-9]|1463552[0-6][0-9]{2}|146355[01][0-9]{3}|14635[0-4][0-9]{4}|1463[0-4][0-9]{5}|146[0-2][0-9]{6}|14[0-5][0-9]{7}|139[0-9]{7}|1389[0-9]{6}|1388[6-9][0-9]{5}|13885[4-9][0-9]{4}|138853[5-9][0-9]{3}|1388534[4-9][0-9]{2})[0-9]{10}$"},"sha256":{"type":"string"},"mutual_friends":{"type":"array","items":{"type":"integer"}},"server_id":{"type":"integer","minimum":1}},"required":["did","sha256","mutual_friends"],"additionalProperties":false},"minItems":1},"friends":{"type":"array","items":{"type":"object","properties":{"user_id":{"type":"integer","minimum":1},"uid":{"type":"string"},"provider":{"type":"string","pattern":"^(facebook|flickr|foursquare|google_oauth2|instagram|linkedin|twitter|vkontakte)$"},"user_name":{"type":"string"},"api_profile_picture_url":{"type":"string"},"friend":{"type":"integer","minimum":1,"maximum":8},"sha256":{"type":"string"},"old_sha256":{"type":"string"},"remote_sha256":{"type":"array","items":{"type":"object","properties":{"server_id":{"type":"integer"},"sha256":{"type":"string"}},"required":["server_id","sha256"],"additionalProperties":false},"minItems":1},"refresh":{"type":"boolean"}},"required":["user_id","uid","provider","user_name","friend"],"additionalProperties":false}},"friends_sha256_update_at":{"type":"integer","minimum":1388534400,"maximum":1463552737},"error":{"type":"string"},"new_gifts":{"type":"object","title":"New gifts response with created_at_server = true or an error message for each gift in new gifts request","properties":{"error":{"type":"string"},"gifts":{"type":"array","items":{"type":"object","properties":{"gid":{"type":"string","pattern":"^(146355273[0-7]|14635527[0-2][0-9]|1463552[0-6][0-9]{2}|146355[01][0-9]{3}|14635[0-4][0-9]{4}|1463[0-4][0-9]{5}|146[0-2][0-9]{6}|14[0-5][0-9]{7}|139[0-9]{7}|1389[0-9]{6}|1388[6-9][0-9]{5}|13885[4-9][0-9]{4}|138853[5-9][0-9]{3}|1388534[4-9][0-9]{2})[0-9]{10}$"},"created_at_server":{"type":"boolean"},"error":{"type":"string"}},"required":["gid","created_at_server"],"additionalProperties":false},"minItems":1},"no_errors":{"type":"integer"}},"additionalProperties":false},"new_servers":{"type":"array","title":"New servers response with internal server id and sha256 signature. Blank server_id for unknown servers","items":{"type":"object","properties":{"sha256":{"type":"string"},"server_id":{"type":"integer","minimum":0}},"required":["sha256"],"additionalProperties":false}},"verify_gifts":{"type":"object","title":"Server verify gifts response with verified_at_server true or false for each gifts in verify gifts request","properties":{"error":{"type":"string"},"gifts":{"type":"array","items":{"type":"object","properties":{"seq":{"type":"integer"},"gid":{"type":"string","pattern":"^(146355273[0-7]|14635527[0-2][0-9]|1463552[0-6][0-9]{2}|146355[01][0-9]{3}|14635[0-4][0-9]{4}|1463[0-4][0-9]{5}|146[0-2][0-9]{6}|14[0-5][0-9]{7}|139[0-9]{7}|1389[0-9]{6}|1388[6-9][0-9]{5}|13885[4-9][0-9]{4}|138853[5-9][0-9]{3}|1388534[4-9][0-9]{2})[0-9]{10}$"},"verified_at_server":{"type":"boolean"}},"required":["seq","gid","verified_at_server"],"additionalProperties":false},"minItems":1}},"additionalProperties":false},"delete_gifts":{"type":"object","title":"Server delete gifts response with error message, gifts and number of errors","properties":{"error":{"type":"string"},"gifts":{"type":"array","title":"Gifts array. Deleted_at_server = true or an error message for each gift in delete gifts request","items":{"type":"object","properties":{"gid":{"type":"string","pattern":"^(146355273[0-7]|14635527[0-2][0-9]|1463552[0-6][0-9]{2}|146355[01][0-9]{3}|14635[0-4][0-9]{4}|1463[0-4][0-9]{5}|146[0-2][0-9]{6}|14[0-5][0-9]{7}|139[0-9]{7}|1389[0-9]{6}|1388[6-9][0-9]{5}|13885[4-9][0-9]{4}|138853[5-9][0-9]{3}|1388534[4-9][0-9]{2})[0-9]{10}$"},"deleted_at_server":{"type":"boolean"},"key":{"type":"string"},"options":{"type":"object"},"error":{"type":"string"}},"required":["gid","deleted_at_server"],"additionalProperties":false},"minItems":1},"no_errors":{"type":"integer"}},"additionalProperties":false},"new_comments":{"type":"object","properties":{"error":{"type":"string"},"comments":{"type":"array","items":{"type":"object","properties":{"cid":{"type":"string","pattern":"^(146355273[0-7]|14635527[0-2][0-9]|1463552[0-6][0-9]{2}|146355[01][0-9]{3}|14635[0-4][0-9]{4}|1463[0-4][0-9]{5}|146[0-2][0-9]{6}|14[0-5][0-9]{7}|139[0-9]{7}|1389[0-9]{6}|1388[6-9][0-9]{5}|13885[4-9][0-9]{4}|138853[5-9][0-9]{3}|1388534[4-9][0-9]{2})[0-9]{10}$"},"created_at_server":{"type":"boolean"},"error":{"type":"string"}},"required":["cid","created_at_server"],"additionalProperties":false},"minItems":1},"no_errors":{"type":"integer"}},"additionalProperties":false},"verify_comments":{"type":"object","properties":{"error":{"type":"string"},"comments":{"type":"array","items":{"type":"object","properties":{"seq":{"type":"integer"},"cid":{"type":"string","pattern":"^(146355273[0-7]|14635527[0-2][0-9]|1463552[0-6][0-9]{2}|146355[01][0-9]{3}|14635[0-4][0-9]{4}|1463[0-4][0-9]{5}|146[0-2][0-9]{6}|14[0-5][0-9]{7}|139[0-9]{7}|1389[0-9]{6}|1388[6-9][0-9]{5}|13885[4-9][0-9]{4}|138853[5-9][0-9]{3}|1388534[4-9][0-9]{2})[0-9]{10}$"},"created_at_server":{"type":"boolean"}},"required":["seq","cid","created_at_server"],"additionalProperties":false},"minItems":1}},"additionalProperties":false},"pubkeys":{"type":"array","title":"Array with requested public keys to client","description":"Response for a remote device will be returned in a later pubkeys request. Blank pubkey is returned for unknown device","items":{"type":"object","properties":{"did":{"type":"string","pattern":"^(146355273[0-7]|14635527[0-2][0-9]|1463552[0-6][0-9]{2}|146355[01][0-9]{3}|14635[0-4][0-9]{4}|1463[0-4][0-9]{5}|146[0-2][0-9]{6}|14[0-5][0-9]{7}|139[0-9]{7}|1389[0-9]{6}|1388[6-9][0-9]{5}|13885[4-9][0-9]{4}|138853[5-9][0-9]{3}|1388534[4-9][0-9]{2})[0-9]{10}$"},"pubkey":{"type":["NilClass","null","string"]}},"required":["did"],"additionalProperties":false},"minItems":1},"expired_tokens":{"type":"array","items":{"type":"string","pattern":"^(facebook|flickr|foursquare|google_oauth2|instagram|linkedin|twitter|vkontakte)$"}},"oauths":{"type":"array","items":{"type":"object","properties":{"provider":{"type":"string","pattern":"^(facebook|flickr|foursquare|google_oauth2|instagram|linkedin|twitter|vkontakte)$"},"user_id":{"type":"string"},"token":{"type":"string"},"expires_at":{"type":"integer","minimum":1420070400,"maximum":1471501537},"refresh_token":{"type":"string"}},"required":["provider","user_id","token","expires_at"],"additionalProperties":false}},"messages":{"type":"object","title":"Response with messages from other clients to client","properties":{"messages":{"type":"array","title":"Array with messages from other clients to client","items":{"type":"object","properties":{"receiver_did":{"type":"string","pattern":"^(146355273[0-7]|14635527[0-2][0-9]|1463552[0-6][0-9]{2}|146355[01][0-9]{3}|14635[0-4][0-9]{4}|1463[0-4][0-9]{5}|146[0-2][0-9]{6}|14[0-5][0-9]{7}|139[0-9]{7}|1389[0-9]{6}|1388[6-9][0-9]{5}|13885[4-9][0-9]{4}|138853[5-9][0-9]{3}|1388534[4-9][0-9]{2})[0-9]{10}$"},"sender_did":{"type":"string","pattern":"^(146355273[0-7]|14635527[0-2][0-9]|1463552[0-6][0-9]{2}|146355[01][0-9]{3}|14635[0-4][0-9]{4}|1463[0-4][0-9]{5}|146[0-2][0-9]{6}|14[0-5][0-9]{7}|139[0-9]{7}|1389[0-9]{6}|1388[6-9][0-9]{5}|13885[4-9][0-9]{4}|138853[5-9][0-9]{3}|1388534[4-9][0-9]{2})[0-9]{10}$"},"sender_sha256":{"type":"string"},"server":{"type":"boolean"},"encryption":{"type":"string","pattern":"^(rsa|sym|mix)$"},"key":{"type":"string"},"message":{"type":"string"}},"required":["sender_did","server","encryption","message"],"additionalProperties":false},"minItems":1},"error":{"type":"string"}},"additionalProperties":false}},"required":["interval"],"additionalProperties":false}
NavCtrl.ping: errors :
  {"message":"Missing required property: created_at_server","params":{"key":"created_at_server"},"code":302,
   "dataPath":"/verify_comments/comments/0","schemaPath":"/properties/verify_comments/properties/comments/items/required/2","subErrors":null}
GiftService.verify_comments_request: Warning. Found 0 local and 1 remote not yet verified comments in buffer.
GiftService.process_messages: 1 messages was moved from mailbox.read to mailbox.inbox
GiftService.receive_message_send_gifts: mailbox  = {"did":"14311621396607257930","sha256":"ZnDMJUWStVAS9Zmvzx7Z2GHUDkKgShIlRvxPNj1m5Uc=","mutual_friends":[2,3],"server_id":1,"key":"14311621396607257930ZnDMJUWStVAS9Zmvzx7Z2GHUDkKgShIlRvxPNj1m5Uc=","online":true,"inbox":[],"read":[],"outbox":[],"sending":[],"sent":[{"mid":"14319342930632741079","request_mid":"14319342826847294355","msgtype":"sync_gifts","users":["kYDksLgCZUhxoGmapa5bAshZ0qylNPGkfg2WrmogF1Y="],"request_gifts":{"mid":"14319342930630675113","msgtype":"request_gifts","gifts":["14318503987470039958"]}}],"done":[{"msgtype":"users_sha256","mid":"14319342415639949279","users":[{"user_id":"kYDksLgCZUhxoGmapa5bAshZ0qylNPGkfg2WrmogF1Y="},{"user_id":"UuDJUQ2HbHmPZ08834UYQOIFDqLtQIafmUgeghW8WLI=","sha256":"\u00119<X\u0007ÞÖ¨ÁW\u001eÜ¥Á!Q×ï\u0007\u0012Èi\u000b\u0011Äò"}]},{"mid":"14319342715683313644","request_mid":"14319342462133092793","msgtype":"gifts_sha256","ignore_invalid_gifts":[],"users":["kYDksLgCZUhxoGmapa5bAshZ0qylNPGkfg2WrmogF1Y="],"gifts":[]}],"error":[]}
GiftService.receive_message_send_gifts: msg      = {"mid":"14319342827048541482","msgtype":"send_gifts","gifts":[{"gid":"14318503987470039958","giver_user_ids":[2],"receiver_user_ids":[],"created_at_client":1431850398,"created_at_server":1,"currency":"usd","direction":"giver","description":"client 1","comments":[{"cid":"14318504067620296473","user_ids":[2],"currency":"usd","comment":"client 1","created_at_client":1431850406,"created_at_server":1,"in_verify_comments":1431934309,"verify_seq":-48}],"sha256":"\u0004uzÌªs´IöÜÍnQ\u001c\u001d\u001b_¥»cij°ªÍrÁÍMá","sha256_gift":"Ürn¥J9³¸Yhj\u001d\róÅ? vböÞ/D1\u0019\u0016ø¶","sha256_comments":"dlM<»0©Mã{U«\tï1³\u000b]Ó0,\u0000´\u001cÙò«","in_verify_gifts":1431934293,"verify_seq":-47,"verified_at_server":true}],"users":[],"servers":[{"server_id":0,"sha256":"KRM0c5eHrFpuQ3yGvHZdBPpGednZCjFsMpQzHTtVvAM="}],"request_mid":"14319342715683313644","pass":1}
GiftService.receive_message_send_gifts: msg.pass = 1
